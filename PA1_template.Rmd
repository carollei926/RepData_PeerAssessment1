---
  title: "Reproducible Research: Peer Assessment 1"
  output: 
  html_document:
  keep_md: true
---
  
  
## Loading and preprocessing the data
  
### set working directery and read in data
```{r}

library(ggplot2)
#setwd("C:/Users/leip/Desktop/Reproducible Research/Course Project 1")
#activity<-read.csv("./activity.csv", header=T, na.strings = "NA")
setwd("C:/Users/leip/Desktop/Reproducible Research/RepData_PeerAssessment1")
unzip(zipfile = "activity.zip")
activity<-read.csv("activity.csv", header=T, na.strings = "NA")
```

## What is mean total number of steps taken per day?
### 1. Calculate the total number of steps taken per day
```{r}
Dsum <-aggregate(activity[,'steps'], by=list(activity$date), FUN=sum, na.rm=TRUE)
names(Dsum) <- c("Date","Sum.step")
```

### 2. Make a histogram of the total number of steps taken each day
```{r}
qplot(Sum.step, data=Dsum, geom="histogram", binwidth = 1000,
      xlab="Total number of steps taken each day")
```

### 3. Calculate and report the mean and median of the total number of steps taken per day
```{r}
Dmean <- aggregate(activity[,'steps'], by=list(activity$date), FUN=mean, na.rm=TRUE)
names(Dmean) <- c("Date","Mean.step")
Dmedian <- aggregate(activity[,'steps'], by=list(activity$date), FUN=median, na.rm=TRUE)
names(Dmedian) <- c("Date","Median.step")
merge(Dmean, Dmedian, "Date")
```
  
## What is the average daily activity pattern?
### 1. Time series plot of the 5-minute interval (x-axis) and the average number of steps taken, 
###    averaged across all days (y-axis)
```{r}
Iavg <- aggregate(activity[,'steps'], by=list(activity$interval), FUN=mean, na.rm=TRUE)
names(Iavg) <- c("Interval","Mean.step")

plot2 <- ggplot(Iavg, aes(Interval, Mean.step)) + geom_line() +
          xlab("5-minute Interval") + ylab("Average Steps Across All Days")
plot2
```

### 2. Which 5-minute interval, on average contains the maximum number of steps?
```{r}
Iavg[which(Iavg$Mean.step==max(Iavg$Mean.step)),  ]
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
